{
  "version": 3,
  "sources": ["../../app/netlify/functions/utils/common.js", "../../app/netlify/functions/gas-estimate.js"],
  "sourceRoot": "/tmp/tmp-4423-Kp7sl40fIRbg",
  "sourcesContent": ["// Standard Response Wrapper\nconst sendResponse = (success, data = null, error = null, statusCode = 200) => {\n    const origin = process.env.ALLOWED_ORIGIN || '*';\n    return {\n        statusCode,\n        headers: {\n            'Content-Type': 'application/json',\n            'Access-Control-Allow-Origin': origin,\n            'Access-Control-Allow-Headers': 'Content-Type',\n            'Access-Control-Allow-Methods': 'GET, POST, OPTIONS'\n        },\n        body: JSON.stringify({\n            success,\n            data,\n            error\n        })\n    };\n};\n\n// Simple In-Memory Cache\nconst cache = new Map();\nconst getCached = (key) => {\n    const item = cache.get(key);\n    if (!item) return null;\n    if (Date.now() > item.expiry) {\n        cache.delete(key);\n        return null;\n    }\n    return item.value;\n};\n\nconst setCached = (key, value, ttlSeconds = 60) => {\n    cache.set(key, {\n        value,\n        expiry: Date.now() + (ttlSeconds * 1000)\n    });\n};\n\n// Basic Rate Limiting (Memory Based - Per Instance)\nconst rateLimitMap = new Map();\nconst checkRateLimit = (ip, limit = 50, windowMs = 60000) => {\n    const now = Date.now();\n    const userStats = rateLimitMap.get(ip) || { count: 0, startTime: now };\n\n    if (now - userStats.startTime > windowMs) {\n        userStats.count = 1;\n        userStats.startTime = now;\n    } else {\n        userStats.count++;\n    }\n\n    rateLimitMap.set(ip, userStats);\n    return userStats.count <= limit;\n};\n\n// Input Validation\nconst isValidPaxiAddress = (address) => {\n    // Paxi addresses (bech32) are typically 44 or 64 characters\n    // Regex allows paxi1 prefix + 38 to 85 alphanumeric characters\n    return /^paxi1[0-9a-z]{38,85}$/.test(address);\n};\n\n// Admin State (Ephemeral)\nlet adminState = {\n    isFrozen: false,\n    blockedAddresses: []\n};\n\nconst getAdminState = () => adminState;\nconst updateAdminState = (newState) => {\n    adminState = { ...adminState, ...newState };\n    return adminState;\n};\n\nmodule.exports = {\n    sendResponse,\n    getCached,\n    setCached,\n    checkRateLimit,\n    isValidPaxiAddress,\n    getAdminState,\n    updateAdminState\n};\n", "const { sendResponse, getCached, setCached } = require('./utils/common');\n\nexports.handler = async (event) => {\n    if (event.httpMethod === 'OPTIONS') return sendResponse(true);\n\n    const { msgs = 1 } = event.queryStringParameters || {};\n    const msgCount = parseInt(msgs);\n\n    const cacheKey = `gas_estimate_${msgCount}`;\n    const cached = getCached(cacheKey);\n    if (cached) return sendResponse(true, cached);\n\n    // Paxi Network Constants\n    const GAS_PRICE = 0.025;\n    const BASE_GAS = 500000;\n    const ADDITIONAL_MSG_GAS = 300000;\n\n    const baseGasLimit = BASE_GAS + (ADDITIONAL_MSG_GAS * (msgCount - 1));\n    const gasLimit = Math.ceil(baseGasLimit * 1.4); // 1.4 safety multiplier as per network standard\n    const estimatedFee = Math.ceil(gasLimit * GAS_PRICE);\n\n    const data = {\n        gasPrice: GAS_PRICE.toString(),\n        gasLimit: gasLimit.toString(),\n        estimatedFee: estimatedFee.toString(),\n        usdValue: \"0.00\" // Requires external Oracle for real USD\n    };\n\n    setCached(cacheKey, data, 300); // Cache for 5 mins\n\n    return sendResponse(true, data);\n};\n"],
  "mappings": ";;;;;;AAAA;AAAA,sCAAAA,UAAAC,SAAA;AACA,QAAMC,gBAAe,CAAC,SAAS,OAAO,MAAM,QAAQ,MAAM,aAAa,QAAQ;AAC3E,YAAM,SAAS,QAAQ,IAAI,kBAAkB;AAC7C,aAAO;AAAA,QACH;AAAA,QACA,SAAS;AAAA,UACL,gBAAgB;AAAA,UAChB,+BAA+B;AAAA,UAC/B,gCAAgC;AAAA,UAChC,gCAAgC;AAAA,QACpC;AAAA,QACA,MAAM,KAAK,UAAU;AAAA,UACjB;AAAA,UACA;AAAA,UACA;AAAA,QACJ,CAAC;AAAA,MACL;AAAA,IACJ;AAGA,QAAM,QAAQ,oBAAI,IAAI;AACtB,QAAMC,aAAY,CAAC,QAAQ;AACvB,YAAM,OAAO,MAAM,IAAI,GAAG;AAC1B,UAAI,CAAC,KAAM,QAAO;AAClB,UAAI,KAAK,IAAI,IAAI,KAAK,QAAQ;AAC1B,cAAM,OAAO,GAAG;AAChB,eAAO;AAAA,MACX;AACA,aAAO,KAAK;AAAA,IAChB;AAEA,QAAMC,aAAY,CAAC,KAAK,OAAO,aAAa,OAAO;AAC/C,YAAM,IAAI,KAAK;AAAA,QACX;AAAA,QACA,QAAQ,KAAK,IAAI,IAAK,aAAa;AAAA,MACvC,CAAC;AAAA,IACL;AAGA,QAAM,eAAe,oBAAI,IAAI;AAC7B,QAAM,iBAAiB,CAAC,IAAI,QAAQ,IAAI,WAAW,QAAU;AACzD,YAAM,MAAM,KAAK,IAAI;AACrB,YAAM,YAAY,aAAa,IAAI,EAAE,KAAK,EAAE,OAAO,GAAG,WAAW,IAAI;AAErE,UAAI,MAAM,UAAU,YAAY,UAAU;AACtC,kBAAU,QAAQ;AAClB,kBAAU,YAAY;AAAA,MAC1B,OAAO;AACH,kBAAU;AAAA,MACd;AAEA,mBAAa,IAAI,IAAI,SAAS;AAC9B,aAAO,UAAU,SAAS;AAAA,IAC9B;AAGA,QAAM,qBAAqB,CAAC,YAAY;AAGpC,aAAO,yBAAyB,KAAK,OAAO;AAAA,IAChD;AAGA,QAAI,aAAa;AAAA,MACb,UAAU;AAAA,MACV,kBAAkB,CAAC;AAAA,IACvB;AAEA,QAAM,gBAAgB,MAAM;AAC5B,QAAM,mBAAmB,CAAC,aAAa;AACnC,mBAAa,EAAE,GAAG,YAAY,GAAG,SAAS;AAC1C,aAAO;AAAA,IACX;AAEA,IAAAH,QAAO,UAAU;AAAA,MACb,cAAAC;AAAA,MACA,WAAAC;AAAA,MACA,WAAAC;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACJ;AAAA;AAAA;;;AClFA,IAAM,EAAE,cAAc,WAAW,UAAU,IAAI;AAE/C,QAAQ,UAAU,OAAO,UAAU;AAC/B,MAAI,MAAM,eAAe,UAAW,QAAO,aAAa,IAAI;AAE5D,QAAM,EAAE,OAAO,EAAE,IAAI,MAAM,yBAAyB,CAAC;AACrD,QAAM,WAAW,SAAS,IAAI;AAE9B,QAAM,WAAW,gBAAgB,QAAQ;AACzC,QAAM,SAAS,UAAU,QAAQ;AACjC,MAAI,OAAQ,QAAO,aAAa,MAAM,MAAM;AAG5C,QAAM,YAAY;AAClB,QAAM,WAAW;AACjB,QAAM,qBAAqB;AAE3B,QAAM,eAAe,WAAY,sBAAsB,WAAW;AAClE,QAAM,WAAW,KAAK,KAAK,eAAe,GAAG;AAC7C,QAAM,eAAe,KAAK,KAAK,WAAW,SAAS;AAEnD,QAAM,OAAO;AAAA,IACT,UAAU,UAAU,SAAS;AAAA,IAC7B,UAAU,SAAS,SAAS;AAAA,IAC5B,cAAc,aAAa,SAAS;AAAA,IACpC,UAAU;AAAA;AAAA,EACd;AAEA,YAAU,UAAU,MAAM,GAAG;AAE7B,SAAO,aAAa,MAAM,IAAI;AAClC;",
  "names": ["exports", "module", "sendResponse", "getCached", "setCached"]
}
